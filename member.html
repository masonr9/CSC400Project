<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Member Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
  <h1>Library Management System</h1>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="catalog.html">Catalog</a></li>
      <li><a href="contact.html">Contact Us</a></li>
      <li><button id="logoutBtn" class="logout-btn">Logout</button></li>
    </ul>
  </nav>
</header>

<main>
  <h2 id="welcomeMessage"></h2>

  <section>
    <h3>My Account</h3>
    <ul class="task-list">
      <li><a href="catalog.html">Search & Borrow Books</a></li>
      <li>Borrowing History</li>
      <li>Reservations</li>
      <li>Fines & Payments</li>
    </ul>
  </section>
</main>

<script>
  // ✅ Check login status
  let loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));
  if (!loggedInUser || loggedInUser.role !== "Member") {
    // Not logged in or wrong role → redirect
    window.location.href = "login.html";
  } else {
    // Show welcome message
    document.getElementById("welcomeMessage").innerText = 
      "Welcome, " + loggedInUser.name + " — " + loggedInUser.role;
  }

  // ✅ Logout + log event
  document.getElementById("logoutBtn").addEventListener("click", function() {
    let logs = JSON.parse(localStorage.getItem("userLogs")) || [];

    if (loggedInUser) {
      let timestamp = new Date().toLocaleString();
      logs.push({
        user: loggedInUser.name,
        action: "Logged out (" + loggedInUser.role + ")",
        time: timestamp
      });
      localStorage.setItem("userLogs", JSON.stringify(logs));
    }

    localStorage.removeItem("loggedInUser");
    window.location.href = "login.html";
  });
</script>

</body>
</html>

